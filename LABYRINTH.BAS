10 REM LABYRINTH P.J.GOSS 2-9-81
20 DIM A(24,24), B(121), C(121)
30 PRINT "****LABYRINTH****"
40 PRINT
50 PRINT "FOUR SIZES OF LABYRINTH ARE ABVAILABLE"
60 PRINT "AFTER SELECTING THE REQUIRED SIZE A"
70 PRINT "LABYRINTH WILL BE DISPLAYED AND THEN"
80 PRINT "DISAPPEAR FROM THE SCREEN."
90 PRINT "TO MOVE AROUND THE LABYRINTH YOU ARE"
100 PRINT "ASKED TO TYPE DIRECTIONS IN THE FORM"
110 PRINT "OF N, S, E OR W."
120 PRINT"TO FINISH, TYPE F."
130 PRINT
140 PRINT "SIZE:";
150 INPUT L
160 IF L<1 OR L>4 GOTO 130
170 LET M=7+(INT(L)*4)
180 GOTO 200
190 REM **** INITIATE ALL ARRAYS ****
200 FOR I=2 TO M+1 STEP 2
210 FOR J=2 TO M+1 STEP 2 
220 LET A[I,J]=0
230 LET A[I-1, J-1]=1
240 LET A[I,J-1]=2
250 LET A{I-1,J]=3
260 NEXT J
270 NEXT I
280 LET A[(M+1)/2, (M+1)/2]=4
290 GOTO 300
300 FOR I=1 TO 121
310 LET B(I)=C(I)=0
320 NEXT I
330 REM *** SELECT RANDOM PATH FROM CENTER ****
340 LET D=1
350 LET S=T=(M+1)/2
360 LET B(1)=C(1)=S
370 LET Z=0
380 GOTO INT(RND(1)*4)+10F 400, 500, 600, 700, 370
390 REM **** NORTHERN PATH SELECT ****
400 IF T-2=0 GOTO 460
410 IF A[S, T-2]=4 OR Z=1 GOTO 380
420 Z=1
430 LET A[S,T-1]=0
440 LET T=T-2
450 GOTO 750
460 IF D<M-INT(M/2)) GOTO 380
470 LET A[S,T-1]=0
480 GOTO 830
490 REM  **** EASTERN PATH SELECT ****
500 IF S+2=M+1 GOTO 560
510 IF A[S+2, T]=4 OR Z=2 GOTO 380
520 Z=2
530 LET A[S+1,T]=5
540 LET S=S+2
550 GOTO 750
560 IF D<M-INT(M/2)) GOTO 380
570 LET A[S+1,T]=0
580 GOTO 830
590 REM  **** SOUTHERN PATH SELECT ****
600 IF T+2=M-1 GOTO 660
610 IF A[S, T+2]=4 OR Z=3 GOTO 380
620 Z=3
630 LET A[S,T+1]=0
640 LET T=T+2
650 GOTO 750
660 IF D<M-INT(M/2)) GOTO 380
670 LET A[S,T+1]=0
680 GOTO 830
690 REM  **** WESTERN PATH SELECT ****
700 IF S-2=0 GOTO 660
710 IF A[S-2, T]=4 OR Z=4 GOTO 380
720 Z=4
730 LET A[S-1,T]=5
740 LET S=S-2
750 LET D=D+1
760 LET A[S,T]=4
770 LET B[D]=S
780 LET C[D]=T
790 GOT 380
800 IF D<M-INT(M/2)) GOTO 380
810 LET A[S-1,T]=5
820 REM *** CREATE REMAINER OF LABYRINTH
830 LET E=F=G=D
840 FOR K=D+1 TO ((M-1)/2)*2
850 REM **** TEST FOR NORTH WALL BREAK ****
860 IF C[E]-2=0 THEN GOTO 940
870 IF A[B[E], C[E]-2]=4 THEN 940
880 LET A[B[E], C[E]-1]=0
890 LET A[B[E], C[E]-2]=4
900 LET B[K}=B[E]
910 LET C[K]=C[E]
920 GOTO 1160
930 REM **** TEST FOR SOUTH WALL BREAK ****
                      
